<!DOCTYPE html>
<html lang="zh">

<head>
    <meta charset="UTF-8">
    <title>古诗词</title>
    <link href="https://cdn.staticfile.org/twitter-bootstrap/3.4.1/css/bootstrap.min.css" rel="stylesheet">
    <style type="text/css">
        .cardBox {
            width: 200px;
            box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);
            text-align: center;
            float: left;
            margin-right: 10px;
            padding: 5px;
            padding-top: 15px;
        }

        .headerBox {
            color: #fff;
            padding: 10px;
            font-size: 15px;
            height: 70px;
        }

        .headerBox-label {
            border-radius: .25em;
            background-color: rgb(51, 106, 209);
            color: #fff;
        }

        .bodyBox {
            padding: 10px;
        }

        .bodyBox p {
            margin-left: 5px;
        }
    </style>
</head>

<body>
    <div id="gs-view">

    </div>
    <script>
        function sleep(ms) {
            return new Promise((resolve) => setTimeout(resolve, ms));
        }
        async function loadPoetry(gsid, gstitle, gsdynasty, gsauthor, gstext) {
            var poetryStr = '<div class="cardBox">' +
                '<div class="headerBox" style="background-color: #4caf50;">' +
                '<p name="gs-id" style="display: none;">' + gsid + '</p>' +
                '<p name="gs-title">' + gstitle + '</p>' +
                '<p><span name="gs-dynasty">' + gsdynasty + '</span>：' +
                '<a name="gs-author" href="" class="label headerBox-label">' + gsauthor + '</a></p>' +
                '</div><div class="bodyBox" name="gs-text">' + gstext + '</div></div>';
            document.getElementById("gs-view").innerHTML += poetryStr;
        }
        async function getPoetry() {
            for (var i = 1; i < 400000; i++) {
                var url = "https://libpoetry.github.io/data/by-id/"+i.toString()+".json";
                fetch(url)
                    .then(function (resp) { return jtext = resp.json(); })
                    .then(function (poetryObj) {
                        loadPoetry(poetryObj.id, poetryObj.title, poetryObj.dynasty, poetryObj.author, poetryObj.text)
                    })
                    .catch(function(e){console.log(e)});
                var temple = await sleep(80);
            }
        }
        getPoetry();
    </script>
</body>

</html>
